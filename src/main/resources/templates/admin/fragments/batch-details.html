<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<!-- Batch Details Modal Fragment -->
<div th:fragment="batch-details-content">

    <!-- Batch Information Section -->
    <div class="info-section">
        <h3>Batch Information</h3>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">Batch ID</span>
                <span class="info-value" th:text="${batch.id}">1</span>
            </div>
            <div class="info-item">
                <span class="info-label">Batch Name</span>
                <span class="info-value" th:text="${batch.batchName}">Left Turn IPA</span>
            </div>
            <div class="info-item">
                <span class="info-label">Tank</span>
                <span class="info-value" th:text="'Tank #' + ${batch.tankId}">Tank #1</span>
            </div>
            <div class="info-item">
                <span class="info-label">Status</span>
                <span th:if="${batch.active}" class="info-value badge badge-active">Active</span>
                <span th:if="${!batch.active}" class="info-value badge badge-completed">Completed</span>
            </div>
            <div class="info-item">
                <span class="info-label">Start Date</span>
                <span class="info-value" th:text="${#temporals.format(batch.startDate, 'MMM dd, yyyy HH:mm')}">Oct 10, 2025 14:30</span>
            </div>
            <div class="info-item" th:if="${batch.completionDate != null}">
                <span class="info-label">Completion Date</span>
                <span class="info-value" th:text="${#temporals.format(batch.completionDate, 'MMM dd, yyyy HH:mm')}">Oct 22, 2025 10:15</span>
            </div>
            <div class="info-item">
                <span class="info-label">Days in Fermentation</span>
                <span class="info-value" th:text="${batch.daysInFermentation} + ' days'">12 days</span>
            </div>
        </div>
    </div>

    <!-- Transaction History -->
    <div th:if="${transactions != null && !transactions.isEmpty()}" class="info-section">
        <h3>Transaction History</h3>
        <table class="transaction-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Quantity</th>
                    <th>User</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="txn : ${transactions}">
                    <td th:text="${#temporals.format(txn.transactionDate, 'MMM dd, HH:mm')}">Oct 10, 14:30</td>
                    <td>
                        <span class="txn-type"
                              th:classappend="${#strings.contains(txn.transactionType.typeName, 'Transfer')} ? 'txn-transfer' :
                                             (${#strings.contains(txn.transactionType.typeName, 'Addition')} ? 'txn-addition' :
                                             (${#strings.contains(txn.transactionType.typeName, 'Sample')} ? 'txn-sample' :
                                             (${#strings.contains(txn.transactionType.typeName, 'Waste')} ? 'txn-waste' : '')))"
                              th:text="${txn.transactionType.typeName}">
                            Cider Addition
                        </span>
                    </td>
                    <td>
                        <span th:text="${#numbers.formatDecimal(txn.quantity, 1, 2)}">92.00</span>
                        <span th:text="${txn.quantityUnit.abbreviation}">gal</span>
                    </td>
                    <td th:text="${txn.userId != null ? 'User ' + txn.userId : '-'}">User 1</td>
                    <td th:text="${txn.notes != null ? txn.notes : '-'}">Initial cider addition</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Empty State (no transactions) -->
    <div th:if="${transactions == null || transactions.isEmpty()}" class="info-section">
        <p class="text-center" style="color: #95a5a6; font-style: italic;">
            No transactions recorded for this batch.
        </p>
    </div>

    <!-- Styles -->
    <style>
        .info-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .info-section h3 {
            margin: 0 0 1rem 0;
            color: #2c3e50;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.85rem;
            color: #7f8c8d;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 1rem;
            color: #2c3e50;
            font-weight: 600;
        }

        /* Transaction Table */
        .transaction-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 6px;
            overflow: hidden;
        }

        .transaction-table thead {
            background-color: #34495e;
            color: white;
        }

        .transaction-table th {
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .transaction-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #ecf0f1;
        }

        .transaction-table tbody tr:last-child td {
            border-bottom: none;
        }

        .transaction-table tbody tr:hover {
            background-color: #f8f9fa;
        }

        /* Transaction Type Badges */
        .txn-type {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .txn-addition {
            background-color: #d4edda;
            color: #155724;
        }

        .txn-transfer {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .txn-sample {
            background-color: #fff3cd;
            color: #856404;
        }

        .txn-waste {
            background-color: #f8d7da;
            color: #721c24;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-active {
            background-color: #27ae60;
            color: white;
        }

        .badge-completed {
            background-color: #95a5a6;
            color: white;
        }

        .text-center {
            text-align: center;
        }
    </style>

</div>

</html>
